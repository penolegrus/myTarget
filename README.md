# myTarget
Тестовое задание для myTarget

# Тесты на экране с рекламой 
Создан класс AdsTest в котором реализовано 3 теста.

1) test_resumeVideo: происходит открытие видео рекламы, на которой нажимается пауза, после чего нажимается кнопка воспроизвести. Видео продолжает идти

2) test_webview: происходит открытие обычной рекламы, после чего нажимается кнопка закрыть. Убеждается, то что реклама закрылась

3) test_hideAdByReason: Открывает Image promo рекламу, нажимает кнопку AdChoice, выбирает причину, реклама закрывается

Не понял как adChoices достать для нажатия на кнопку (!) и получить options с вариантами ответов. Получилось сделать только через поиск по родительским элементам на экране. Как я понял через метод onView можно выполнить какое то действие на экране с определенным R.id элементом или дргуим локатором, который может быть найден в проекте.   

При нажатии на кнопку LOAD происходит get запрос на сервер и возвращается html страница в которой есть json. На основе этого json появляется экран с рекламой. В этом json есть как раз атрибуты adChoices, options, ageRestrictions и другие.

Я находил переменную adChoices в проекте в классе com.my.target.by, но так и не понял как с ней взаимодействовать. Скорее всего я что то не то делал. В теории как я понял, нужно обращаться к кнопкам по названиям из json и кликать по ним.
Помимо этого можно получать значения и сравнивать на Null, делать проверки на то, что json файл пришел не пустой

# Дополнительно сделал простые тесты именно в самом приложении

BannersTest#test_checkParagraphCount - Проверяет, что количесто абзацев после нажатия кнопки Show во вкладке Banners равно 10

BannersTest#test_checkParagraphCount2 - тоже самое, что и предыдущее, только используется другой способ проверки

InterstitialTest##test_checkCloseAd - Проверяет что реклама открылась и нажалась кнопка закрыть

MainTest#test_addNewUnitWithoutSlot - Добавляет новый юнит без slot id. Проверяет что юнит не добавлен и окно с добавлением все еще видно

MainTest#test_addNewUnit - Добавляет новый юнит с определенным name и slot id. Проверяет, что юнит добавлен

# Скриншоты после падения теста

Не реализовал, но в теории это выглядит так: 

Создается @Rule в тестовом классе, в котором нужно переопределить метод failed из класса TestWather. В этом методе нужно указать путь, куда будет сохраняться скриншот и придумать уникальное название для скриншота, чтобы переменные не повторялись (Как вариант можно получить текущую дату и добавлять к названиию).
Далее через UiAutomator получить текущий скриншот и сохранить его в указанное место. 

Или с помощью библиотеки espresso можно переопределить метод FailureHandler и в нем реализовать логику создания скриншота.  
